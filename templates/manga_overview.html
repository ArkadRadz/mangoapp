{% extends "base.html" %}

{% import 'pagination.html' as pagination %}

{% block content %}
    <div class="row text-center">
        <ul class="list-inline">
            <li class="list-inline-item"><strong>{{ manga.title }}</strong></li>
            <li class="list-inline-item"><a href="{{ url_for('author_overview', id=manga_author.id) }}"> {{ manga_author.name }} </a></li>
        </ul>
    </div>

    {% with images=manga_images.items, current_page=manga_images.page %}
        {% include "manga_images.html" %}
    {% endwith %}

    {{ pagination.render_pagination(manga_images, url_for('manga_overview', id=manga.id) + "/") }}

    <script>
        function showSpoilers() {
            let images = document.getElementsByClassName("spoiler-image");

            for (let image of images) { image.classList.remove('blur-image'); }

            let hideButton = document.getElementById("hide-spoilers-button");

            if (hideButton.classList.contains('disabled')) {
                hideButton.classList.remove('disabled');
            }

        
            let showButton = document.getElementById("show-spoilers-button");
            showButton.classList.add('disabled');

            document.cookie = 'spoilers=show';
        }

        function hideSpoilers() {
            let images = document.getElementsByClassName("spoiler-image");

            for (let image of images) { image.classList.add('blur-image'); }

            let showButton = document.getElementById("show-spoilers-button");

            if (showButton.classList.contains('disabled')) {
                showButton.classList.remove('disabled');
            }

            let hideButton = document.getElementById("hide-spoilers-button");
            hideButton.classList.add('disabled');
            
            document.cookie = 'spoilers=hide';
        }
    </script>
{% endblock %}

{% block additional_element %}
    <div class="row">
        <div class="col">
            <button 
            class="btn btn-primary mb-2 btn-lg h-100 w-100 {% if request.cookies.get('spoilers') == 'show' %}disabled{% endif %}" 
            onclick="showSpoilers()" id="show-spoilers-button">
                <div class="row">
                    <span class="text-center">Show spoilers</span>
                </div>
                <div class="row">
                    <i class="fas fa-eye"></i>
                </div>
            </button>
        </div>
        <div class="col">
            <button onclick="hideSpoilers()" id="hide-spoilers-button"
            class="btn btn-primary mb-2 btn-lg h-100 w-100 {% if request.cookies.get('spoilers') == 'hide' %}disabled{% endif %}">
                <div class="row">
                    <span class="text-center">Hide spoilers</span>
                </div>
                <div class="row">
                    <i class="fas fa-eye-slash"></i>
                </div>
            </button>
        </div>
    </div>
{% endblock %}